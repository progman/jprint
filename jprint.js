//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
// 0.0.1
// Alexey Potehin <gnuplanet@gmail.com>, http://www.gnuplanet.ru/doc/cv
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
var fs = require('fs');
var vm = require('vm');

function include(path)
{
	var code = fs.readFileSync(path, 'utf-8');
	vm.runInThisContext(code, path);
}

include('./submodule/libcore.js/libcore.js');
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
var file = process.env['FILE'];
var flag_shift = process.env['FLAG_SHIFT'];


if (typeof flag_shift === 'undefined')
{
	flag_shift = false;
}
else
{
	if ((flag_shift.toLowerCase() === 'true') || (flag_shift.toLowerCase() === 'on') || (flag_shift === '1'))
	{
		flag_shift = true;
	}
	else
	{
		flag_shift = false;
	}
}


var filebody = fs.readFileSync(file, 'utf-8');


try
{
	data = JSON.parse(filebody);
}
catch(e)
{
	console.error('invalid json: ' + e.message);
}


body = libcore.jdraw(data, '', flag_shift);
console.log(body);
//---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------//
